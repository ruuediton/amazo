import{r as l,j as e,S as N,s as k}from"./index-BauRbZeW.js";const C=({onNavigate:m,showToast:r})=>{const[s,p]=l.useState(!1),[i,b]=l.useState(!1),[c,g]=l.useState(!1),[n,y]=l.useState(""),[a,h]=l.useState(""),[d,v]=l.useState(""),[o,x]=l.useState(!1),j=async t=>{if(t.preventDefault(),!n||!a||!d){r==null||r("Por favor, preencha todos os campos.","warning");return}if(a.length!==4||!/^\d+$/.test(a)){r==null||r("A nova senha deve ter exatamente 4 números.","warning");return}if(a!==d){r==null||r("As novas senhas não coincidem.","error");return}if(n===a){r==null||r("A nova senha deve ser diferente da atual.","warning");return}x(!0);try{const{data:u,error:f}=await k.rpc("update_withdrawal_password",{p_current_password:n,p_new_password:a});f?r==null||r("Erro ao atualizar senha: "+f.message,"error"):u===!1?r==null||r("Senha atual incorreta.","error"):(r==null||r("Senha de retirada alterada com sucesso!","success"),setTimeout(()=>m("profile"),2e3))}catch{r==null||r("Erro inesperado ao alterar senha.","error")}finally{x(!1)}};return e.jsxs("div",{className:"relative flex min-h-screen w-full flex-col overflow-x-hidden bg-background-dark font-display text-black antialiased",children:[e.jsxs("header",{className:"sticky top-0 z-10 flex items-center justify-between px-4 py-3 bg-background-dark/95 backdrop-blur-md border-b border-gray-200",children:[e.jsx("button",{onClick:()=>m("profile"),className:"flex size-10 items-center justify-center rounded-full hover:bg-white/10 transition-colors",children:e.jsx("span",{className:"material-symbols-outlined text-primary",style:{fontSize:"24px"},children:"arrow_back"})}),e.jsx("h1",{className:"text-lg font-bold leading-tight tracking-tight flex-1 text-center pr-10",children:"Senha de Retirada"})]}),e.jsxs("main",{className:"flex-1 px-5 py-2 flex flex-col",children:[e.jsxs("div",{className:"mb-6 mt-2",children:[e.jsx("h2",{className:"text-[28px] font-bold leading-tight tracking-tight mb-3",children:"Alterar Senha de Retirada"}),e.jsx("p",{className:"text-[text-gray-400] text-base font-normal leading-relaxed",children:"Esta senha será solicitada exclusivamente para confirmar saques, transferências e pagamentos."})]}),e.jsxs("form",{className:"flex flex-col gap-5",onSubmit:j,children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium leading-normal text-black ml-1",children:"Senha de retirada atual"}),e.jsxs("div",{className:"relative flex items-center",children:[e.jsx("input",{value:n,onChange:t=>y(t.target.value.replace(/\D/g,"")),maxLength:4,inputMode:"numeric",className:"w-full h-14 rounded-xl border border-[#423f30] bg-surface-dark px-4 pr-12 text-base text-black placeholder-[text-gray-400] focus:border-primary focus:ring-1 focus:ring-primary outline-none transition-all",placeholder:"Digite a senha atual",type:s?"text":"password"}),e.jsx("button",{type:"button",onClick:()=>p(!s),className:"absolute right-0 top-0 h-full w-12 flex items-center justify-center text-[text-gray-400] hover:text-primary transition-colors",children:e.jsx("span",{className:"material-symbols-outlined",style:{fontSize:"24px"},children:s?"visibility":"visibility_off"})})]})]}),e.jsxs("div",{className:"space-y-1 pt-2",children:[e.jsx("label",{className:"text-sm font-medium leading-normal text-black ml-1",children:"Nova senha de retirada"}),e.jsxs("div",{className:"relative flex items-center",children:[e.jsx("input",{value:a,onChange:t=>h(t.target.value.replace(/\D/g,"")),maxLength:4,inputMode:"numeric",className:"w-full h-14 rounded-xl border border-[#423f30] bg-surface-dark px-4 pr-12 text-base text-black placeholder-[text-gray-400] focus:border-primary focus:ring-1 focus:ring-primary outline-none transition-all",placeholder:"Crie uma nova senha (4 dígitos)",type:i?"text":"password"}),e.jsx("button",{type:"button",onClick:()=>b(!i),className:"absolute right-0 top-0 h-full w-12 flex items-center justify-center text-[text-gray-400] hover:text-primary transition-colors",children:e.jsx("span",{className:"material-symbols-outlined",style:{fontSize:"24px"},children:i?"visibility":"visibility_off"})})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium leading-normal text-black ml-1",children:"Confirmar nova senha de retirada"}),e.jsxs("div",{className:"relative flex items-center",children:[e.jsx("input",{value:d,onChange:t=>v(t.target.value.replace(/\D/g,"")),maxLength:4,inputMode:"numeric",className:"w-full h-14 rounded-xl border border-[#423f30] bg-surface-dark px-4 pr-12 text-base text-black placeholder-[text-gray-400] focus:border-primary focus:ring-1 focus:ring-primary outline-none transition-all",placeholder:"Repita a nova senha",type:c?"text":"password"}),e.jsx("button",{type:"button",onClick:()=>g(!c),className:"absolute right-0 top-0 h-full w-12 flex items-center justify-center text-[text-gray-400] hover:text-primary transition-colors",children:e.jsx("span",{className:"material-symbols-outlined",style:{fontSize:"24px"},children:c?"visibility":"visibility_off"})})]})]}),e.jsx("div",{className:"flex-1 min-h-[40px]"}),e.jsx("button",{type:"submit",disabled:o,className:`w-full h-14 rounded-full bg-primary hover:bg-primary/90 active:scale-[0.98] transition-all flex items-center justify-center shadow-lg shadow-primary/20 mb-6 ${o?"opacity-50":""}`,children:o?e.jsx(N,{size:"w-6 h-6",className:"text-black"}):e.jsx("span",{className:"text-[#181711] text-base font-bold tracking-wide",children:"Confirmar"})})]})]})]})};export{C as default};
