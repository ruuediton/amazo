import{u as j,r as n,s as o,j as e,S as w}from"./index-BauRbZeW.js";const v=({onNavigate:t,showToast:y})=>{const{withLoading:h,showError:p}=j(),[l,u]=n.useState([]),[r,d]=n.useState(!1),[c,x]=n.useState(!1),[m,f]=n.useState(0);n.useEffect(()=>{b()},[]);const b=async()=>{try{const{data:{user:s}}=await o.auth.getUser();if(!s){t("login");return}const{data:a,error:i}=await o.rpc("get_task_screen_data");if(i)throw i;a&&(u(a.purchases||[]),f(a.potential_income||0),d(a.has_collected_today||!1))}catch(s){console.error(s)}},g=async()=>{if(!c){x(!0);try{await h(async()=>{const{data:{user:s}}=await o.auth.getUser();if(!s)throw new Error("SessÃ£o expirada.");const{data:a,error:i}=await o.rpc("collect_daily_income");if(i)throw new Error("Erro de comunicaÃ§Ã£o. Tente novamente.");if(!a.success)throw new Error(a.message||"Erro ao coletar renda.");return d(!0),a.message},"Tarefa diÃ¡ria concluÃ­da!")}catch(s){p(s)}finally{x(!1)}}};return e.jsxs("div",{className:"bg-background-dark font-display text-black transition-colors duration-200 min-h-screen",children:[e.jsxs("div",{className:"relative flex h-full min-h-screen w-full flex-col overflow-x-hidden max-w-md mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 sticky top-0 z-10 bg-background-dark/95 backdrop-blur-sm border-b border-gray-200",children:[e.jsx("div",{onClick:()=>t("home"),className:"flex size-12 shrink-0 items-center justify-center rounded-full hover:bg-white/10 cursor-pointer transition-colors",children:e.jsx("span",{className:"material-symbols-outlined text-primary",children:"arrow_back"})}),e.jsx("h2",{className:"text-lg font-bold leading-tight tracking-[-0.015em] text-center flex-1",children:"Ganhos de Tarefas"}),e.jsx("div",{onClick:()=>t("tutoriais-ganhos-tarefas"),className:"flex size-12 items-center justify-center rounded-full hover:bg-white/10 cursor-pointer",children:e.jsx("span",{className:"material-symbols-outlined text-black",children:"help"})})]}),e.jsx("div",{className:"flex flex-col items-center pt-6 pb-2 px-4",children:e.jsxs("div",{className:"flex items-center gap-2 bg-green-500/10 border border-green-500/20 px-4 py-2 rounded-full shadow-lg shadow-green-500/5",children:[e.jsx("span",{className:"material-symbols-outlined text-green-600 text-[20px]",style:{fontVariationSettings:"'FILL' 1"},children:"trending_up"}),e.jsxs("span",{className:"text-sm font-extrabold text-green-600 uppercase tracking-wider",children:["Hoje: ",r?"+0,00":`+${m.toLocaleString()}`," Kz"]})]})}),e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 relative",children:[e.jsx("div",{className:"absolute w-48 h-48 rounded-full bg-primary/10 animate-pulse"}),e.jsx("div",{className:"absolute w-40 h-40 rounded-full bg-primary/20"}),e.jsx("button",{onClick:g,disabled:r||c,className:"relative z-10 flex flex-col items-center justify-center w-28 h-28 rounded-full bg-primary shadow-[0_0_40px_-10px_rgba(244,209,37,0.6)] transition-transform active:scale-95 cursor-pointer group",children:c?e.jsx(w,{className:"text-[text-black]",size:"w-7 h-7"}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"material-symbols-outlined text-[text-black] text-[40px] mb-1 group-hover:scale-110 transition-transform",style:{fontVariationSettings:"'FILL' 1"},children:r?"task_alt":"power_settings_new"}),e.jsx("span",{className:"text-[text-black] text-[9px] font-black uppercase tracking-tighter",children:r?"Finalizado":"Check-in-Diario"})]})}),e.jsx("p",{className:"mt-6 text-sm font-medium text-primary uppercase tracking-widest animate-pulse",children:r?"Renda Coletada":"Sistema Online"})]}),e.jsxs("div",{className:"mx-4 my-4 p-3 rounded-lg bg-white border-none shadow-md flex items-center gap-3 overflow-hidden",children:[e.jsx("span",{className:"material-symbols-outlined text-primary text-[20px] shrink-0",children:"notifications_active"}),e.jsx("div",{className:"flex-1 overflow-hidden relative h-6",children:e.jsxs("div",{className:"absolute whitespace-nowrap animate-marquee flex items-center text-sm text-black font-bold",children:[e.jsx("span",{className:"mr-12",children:"ðŸ‘‰ As tarefas devem ser realizadas diariamente para receber os ganhos."}),e.jsx("span",{className:"mr-12",children:"ðŸ‘‰ Verifique seus itens ativos para ver os ganhos prontos para coleta."})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 px-4 mb-6",children:[e.jsxs("div",{className:"bg-white p-4 rounded-xl border-none shadow-md",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 text-text-secondary",children:[e.jsx("span",{className:"material-symbols-outlined text-[20px] text-green-600",children:"calendar_view_week"}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-slate-400",children:"Renda Semanal"})]}),e.jsxs("p",{className:"text-lg font-black text-black",children:["Kz ",(m*7).toLocaleString()]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-xl border-none shadow-md",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 text-text-secondary",children:[e.jsx("span",{className:"material-symbols-outlined text-[20px] text-primary",children:"inventory_2"}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-slate-400",children:"Total de Ativos"})]}),e.jsxs("p",{className:"text-lg font-black text-black",children:[l.filter(s=>s.status==="confirmado").length," Itens"]})]})]}),e.jsxs("div",{className:"flex flex-col px-4 pb-32",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-bold leading-tight",children:["Itens Ativos (",l.length,")"]}),e.jsx("span",{onClick:()=>t("purchase-history"),className:"text-xs font-bold text-primary cursor-pointer hover:underline",children:"Ver Todos"})]}),l.length===0?e.jsxs("div",{className:"bg-white p-6 rounded-xl border-none shadow-md text-center",children:[e.jsx("p",{className:"text-gray-600 text-sm font-bold leading-relaxed mb-4",children:"Por favor faÃ§a depÃ³sito para recarregar sua conta Amazon para comprar eletrÃ³nicos na Loja e comeÃ§ar a obter rendimentos."}),e.jsx("button",{onClick:()=>t("deposit"),className:"inline-flex items-center justify-center px-6 h-10 bg-primary/10 border border-primary/20 text-primary text-xs font-bold uppercase rounded-lg active:scale-95 transition-all",children:"Depositar Agora"})]}):l.map(s=>e.jsxs("div",{className:"group flex items-center gap-4 bg-white p-3 rounded-xl mb-3 border-none shadow-md transition-all",children:[e.jsxs("div",{className:"relative w-16 h-16 shrink-0 rounded-lg overflow-hidden bg-white flex items-center justify-center p-1",children:[e.jsx("div",{className:`absolute top-0 right-0 w-3 h-3 ${s.status==="confirmado"?"bg-green-500":s.status==="expirado"?"bg-red-500":"bg-primary"} rounded-full border-2 border-background-dark z-10 -mr-1 -mt-1`}),s.url_produtos?e.jsx("img",{alt:s.nome,className:"object-contain w-full h-full",src:s.url_produtos}):e.jsx("span",{className:"material-symbols-outlined text-gray-600 text-[32px]",children:"memory"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-base font-bold text-black truncate",children:s.nome}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("div",{className:"h-1.5 w-16 bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full bg-primary rounded-full ${s.status==="confirmado"?"w-[70%]":"w-0"}`})}),e.jsx("span",{className:"text-xs text-text-secondary",children:s.status==="confirmado"?"Gerando...":s.status==="expirado"?"Expirado":"Pendente"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm font-bold text-black",children:["+",s.renda_diaria.toLocaleString()," Kz"]}),e.jsx("p",{className:"text-xs text-text-secondary",children:"/dia"})]})]},s.id))]})]}),e.jsx("style",{children:`
        @keyframes marquee {
          0% { transform: translateX(100%); }
          100% { transform: translateX(-100%); }
        }
        .animate-marquee {
          animation: marquee 12s linear infinite;
        }
      `})]})};export{v as default};
