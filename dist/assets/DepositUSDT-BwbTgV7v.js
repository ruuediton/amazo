import{u as R,r,j as e,s as v}from"./index-BauRbZeW.js";const _=({onNavigate:d,showToast:s,data:t})=>{var j,y,N;const{withLoading:x}=R(),[c,k]=r.useState((t==null?void 0:t.amount)||""),[o,w]=r.useState(0),[m,u]=r.useState(!1),[f,S]=r.useState(null),[g,h]=r.useState(!1),p=((j=t==null?void 0:t.bank)==null?void 0:j.iban)||((y=t==null?void 0:t.bank)==null?void 0:y.wallet_address)||"Endereço indisponível",D=((N=t==null?void 0:t.bank)==null?void 0:N.nome_destinatario)||"Destinatário desconhecido",b=r.useCallback(async(a=!1)=>{const n=async()=>{const i=await(await fetch("https://api.exchangerate-api.com/v4/latest/USD")).json();if(i&&i.rates&&i.rates.AOA){const U=i.rates.AOA;w(U),S(new Date)}else throw new Error("Taxa não disponível")};if(a){u(!0);try{await n()}catch{}finally{u(!1)}}else await x(n)},[x]);r.useEffect(()=>{b(!1);const a=setInterval(()=>b(!0),12e4);return()=>clearInterval(a)},[b]);const z=()=>{navigator.clipboard.writeText(p),s==null||s("Endereço copiado!","success")},C=c&&o?(parseFloat(c)*o).toLocaleString("pt-AO",{minimumFractionDigits:2}):"0,00",E=async()=>{const a=parseFloat(c);if(!c||isNaN(a)||a<4){s==null||s("Recarga mínima 4 USDT.","warning");return}if(a>1090){s==null||s("Recarga máxima 1090 USDT.","warning");return}h(!0);try{await x(async()=>{const{data:{user:n}}=await v.auth.getUser();if(!n)throw d("login"),new Error("Sessão expirada.");const{data:l,error:i}=await v.rpc("create_usdt_deposit",{p_amount_usdt:a,p_exchange_rate:o});if(i)throw new Error("Erro de conexão com servidor.");if(l&&!l.success)throw new Error(l.message||"Falha ao criar depósito.");return l.message},"Solicitação criada com sucesso!"),d("home")}catch(n){console.error(n)}finally{h(!1)}};return e.jsxs("div",{className:"bg-background-dark font-display text-black antialiased min-h-screen flex flex-col pb-32",children:[e.jsxs("header",{className:"sticky top-0 z-50 flex items-center justify-between bg-background-dark/95 backdrop-blur-md p-4 pb-2 border-b border-gray-200",children:[e.jsx("button",{onClick:()=>d("profile"),className:"text-primary flex size-10 shrink-0 items-center justify-center rounded-full hover:bg-white/10 transition-colors",children:e.jsx("span",{className:"material-symbols-outlined text-[24px]",children:"arrow_back"})}),e.jsx("h2",{className:"text-black text-lg font-bold leading-tight tracking-tight flex-1 text-center pr-10",children:"Recarregar USDT"})]}),e.jsxs("main",{className:"flex-1 overflow-y-auto px-5 pt-6 no-scrollbar",children:[e.jsxs("div",{className:"flex flex-col items-center text-center mb-8",children:[e.jsx("div",{className:"size-16 bg-[#26a17b]/10 rounded-full flex items-center justify-center mb-4 ring-2 ring-[#26a17b]/20",children:e.jsx("span",{className:"material-symbols-outlined text-[#26a17b]",style:{fontSize:"32px",fontVariationSettings:"'FILL' 1"},children:"currency_bitcoin"})}),e.jsx("h1",{className:"text-2xl font-extrabold tracking-tight mb-2 text-black",children:"Depósito Cripto"}),e.jsxs("p",{className:"text-text-secondary text-sm leading-relaxed max-w-[280px]",children:["Recarregue sua conta usando USDT na rede ",e.jsx("span",{className:"text-black font-bold",children:"TRON (TRC20)"}),"."]})]}),e.jsx("div",{className:"bg-surface-dark rounded-2xl p-6 mb-6 border border-amazon-border shadow-md",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest ml-1",children:"Quantia (USDT)"}),e.jsxs("div",{className:"relative flex items-center",children:[e.jsx("input",{type:"number",value:c,onChange:a=>k(a.target.value),placeholder:"Mínimo 4 USDT",min:"4",max:"1090",className:"w-full bg-surface-dark border border-amazon-border rounded-xl h-16 px-5 text-2xl font-black text-text-primary focus:border-primary focus:ring-1 focus:ring-primary outline-none transition-all placeholder:text-text-secondary/30"}),e.jsx("span",{className:"absolute right-5 text-sm font-bold text-[#26a17b]",children:"USDT"})]}),e.jsxs("div",{className:"flex justify-between items-center px-1",children:[e.jsx("p",{className:"text-xs text-text-secondary font-medium",children:"Equivalente em Kz (Moeda de Destino)"}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsxs("p",{className:"text-sm font-black text-primary",children:["≈ Kz ",C]}),m&&e.jsx("span",{className:"text-[9px] text-text-secondary animate-pulse",children:"Atualizando taxa..."})]})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-[#26a17b]/5 border border-[#26a17b]/10 flex flex-col items-center gap-1",children:[e.jsxs("p",{className:"text-[10px] text-[#26a17b] font-black uppercase tracking-widest",children:["TAXA DE CÂMBIO: 1 USDT = ",o>0?o.toFixed(2):"---"," Kz"]}),f&&e.jsxs("p",{className:"text-[8px] text-text-secondary/60",children:["Atualizado em: ",f.toLocaleTimeString()]})]})]})}),e.jsxs("div",{className:"bg-surface-dark rounded-2xl p-6 border border-amazon-border shadow-md",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-800 uppercase tracking-widest mb-6 text-center",children:"Dados para Transferência"}),e.jsxs("div",{className:"flex flex-col gap-1 mb-4 text-center",children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-700 uppercase tracking-widest",children:"Destinatário"}),e.jsx("p",{className:"text-black font-bold text-sm tracking-wide",children:D})]}),e.jsx("div",{className:"flex justify-center mb-8",children:e.jsxs("div",{className:"p-3 bg-white rounded-2xl shadow-2xl relative group",children:[e.jsx("div",{className:"size-48 bg-gray-100 flex items-center justify-center overflow-hidden rounded-xl border border-gray-200",children:e.jsx("img",{src:`https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${p}`,alt:"USDT TRC20 QR Code",className:"size-full object-cover"})}),e.jsx("div",{className:"absolute inset-0 bg-primary/10 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none rounded-2xl flex items-center justify-center",children:e.jsx("span",{className:"material-symbols-outlined text-black font-black",children:"zoom_in"})})]})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-700 uppercase tracking-widest text-center",children:"Endereço da Carteira (TRC20)"}),e.jsxs("div",{className:"flex items-center gap-2 bg-background-dark p-3 rounded-xl border border-amazon-border",children:[e.jsx("p",{className:"flex-1 text-[13px] font-mono font-bold text-text-primary truncate text-center select-all",children:p}),e.jsx("button",{onClick:z,className:"size-10 bg-primary rounded-lg flex items-center justify-center text-text-primary active:scale-90 transition-transform shadow-lg shadow-primary/20",children:e.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"content_copy"})})]})]})]}),e.jsx("div",{className:"mt-6 p-4 rounded-xl bg-orange-500/10 border border-orange-500/20",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("span",{className:"material-symbols-outlined text-orange-500",children:"warning"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{className:"text-black text-xs font-bold uppercase tracking-tight",children:"Aviso Importante"}),e.jsxs("p",{className:"text-gray-900/80 text-[11px] leading-relaxed mt-1",children:["Envie apenas ",e.jsx("span",{className:"font-bold text-black underline",children:"USDT via rede TRC20"}),". O envio para outras redes ou moedas resultará na perda definitiva dos fundos."]})]})]})}),e.jsx("div",{className:"h-10"})]}),e.jsx("footer",{className:"fixed bottom-0 max-w-md w-full p-4 bg-background-dark/95 backdrop-blur-lg border-t border-amazon-border z-50",children:e.jsxs("button",{onClick:E,disabled:g||m,className:`w-full bg-primary hover:bg-primary-hover text-text-primary font-black py-4 rounded-xl shadow-lg shadow-primary/20 transition-all active:scale-[0.98] flex items-center justify-center gap-2 ${g||m?"opacity-50":""}`,children:[e.jsx("span",{children:"Confirmar Depósito"}),e.jsx("span",{className:"material-symbols-outlined font-bold text-[20px]",children:"send_money"})]})})]})};export{_ as default};
