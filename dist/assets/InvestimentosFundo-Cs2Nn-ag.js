import{r,u as _,s as u,j as e,S as z}from"./index-BauRbZeW.js";const S=({onNavigate:i,showToast:b})=>{const[a,d]=r.useState(null),[o,N]=r.useState([]),{withLoading:h,showError:A}=_(),[x,f]=r.useState(!1),[l,p]=r.useState(""),[n,m]=r.useState(!1),v=r.useMemo(()=>o.reduce((t,s)=>t+(Number(s.total_fundos_disponivel)||0),0),[o]),w=r.useMemo(()=>{if(!a||!l)return 0;const t=Number(l);if(isNaN(t))return 0;const s=a.taxa_retorno/100;return t+t*s},[a,l]),g=r.useMemo(()=>o,[o]);r.useEffect(()=>{j()},[]);const j=async()=>{await h(async()=>{const{data:t,error:s}=await u.from("fundos").select("*").eq("estado",!0).order("data_disponivel",{ascending:!1});if(s)throw s;N(t||[])})},k=async()=>{if(!a||!l)return;const t=Number(l);if(isNaN(t)||t<100){b&&b("Valor mínimo de fundo 100 Kz.","warning");return}f(!0);try{await h(async()=>{const{data:{user:s}}=await u.auth.getUser();if(!s)throw i("login"),new Error("Sessão expirada. Entre novamente.");if(t>Number(a.total_fundos_disponivel))throw new Error(`⚠️ O valor disponível é de ${Number(a.total_fundos_disponivel).toLocaleString("pt-AO")} Kz.`);const{data:c,error:y}=await u.rpc("purchase_fund",{p_fund_id:a.id_fundo,p_amount:t,p_auto_reinvest:n});if(y)throw new Error("Erro de conexão.");if(c&&!c.success)throw new Error(c.message||"Não foi possível realizar o investimento.");return c.message},"Aplicação realizada com sucesso!"),d(null),p(""),m(!1),j()}catch{}finally{f(!1)}};return e.jsxs("div",{className:"bg-background-dark min-h-screen font-display antialiased",children:[e.jsxs("div",{className:"relative h-[240px] w-full overflow-hidden rounded-b-[48px] shadow-2xl bg-[#0F1111]",children:[e.jsx("img",{src:"https://images.unsplash.com/photo-1590283603385-17ffb3a7f29f?auto=format&fit=crop&q=80&w=1000",alt:"Amazon Wealth Header",className:"absolute inset-0 w-full h-full object-cover opacity-60 scale-110"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#0F1111] via-transparent to-black/40"}),e.jsxs("div",{className:"absolute top-8 left-6 right-6 z-10 flex items-center justify-between",children:[e.jsx("button",{onClick:()=>i("home"),className:"size-10 flex items-center justify-center rounded-xl bg-white/10 backdrop-blur-md text-white border border-white/20 active:scale-90 transition-all",children:e.jsx("span",{className:"material-symbols-outlined text-xl",children:"arrow_back_ios_new"})}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"text-primary text-[9px] font-black uppercase tracking-[0.2em]",children:"Amazon Wealth"}),e.jsxs("div",{className:"flex items-center gap-1.5 mt-1 px-2 py-0.5 bg-green-500/10 rounded-full border border-green-500/20",children:[e.jsx("span",{className:"size-1.5 rounded-full bg-green-500 animate-pulse"}),e.jsx("span",{className:"text-green-500 text-[8px] font-bold uppercase tracking-wider",children:"Ao Vivo"})]})]})]}),e.jsxs("div",{className:"absolute bottom-10 left-8 z-10",children:[e.jsx("p",{className:"text-white/50 text-[9px] font-black uppercase tracking-[0.3em] mb-2",children:"Liquidez Total"}),e.jsxs("h1",{className:"text-white text-3xl font-black tabular-nums tracking-tighter",children:[e.jsx("span",{className:"text-primary opacity-80 text-xl mr-1",children:"Kz"}),v.toLocaleString("pt-AO")]}),e.jsx("div",{className:"flex items-center gap-2 mt-3",children:e.jsx("div",{className:"bg-primary/90 text-[#0F1111] px-2.5 py-1 rounded-lg text-[9px] font-black uppercase tracking-widest shadow-lg shadow-primary/20",children:"Oportunidades"})})]})]}),e.jsx("div",{className:"px-6 -mt-4 mb-4 relative z-20",children:e.jsxs("div",{className:"bg-white/80 backdrop-blur-xl border border-white p-1 rounded-2xl flex items-center gap-2 shadow-xl",children:[e.jsxs("div",{className:"flex-1 flex items-center gap-3 px-3 py-2",children:[e.jsx("span",{className:"material-symbols-outlined text-primary text-xl",children:"account_balance_wallet"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[8px] text-slate-400 font-bold uppercase tracking-widest",children:"Saldo disponível"}),e.jsx("span",{className:"text-slate-900 font-black text-[10px]",children:"Ver em Perfil"})]})]}),e.jsx("button",{onClick:()=>i("historico-fundos"),className:"bg-[#0F1111] text-white px-4 py-3 rounded-xl font-black text-[9px] uppercase tracking-widest hover:opacity-90 active:scale-95 transition-all",children:"Carteira"})]})}),e.jsx("section",{className:"overflow-x-auto snap-x snap-mandatory scroll-smooth no-scrollbar mt-4",children:e.jsx("div",{className:"flex items-stretch px-6 gap-5 pb-8",children:g.length>0?g.map(t=>{const s=Number(t.total_fundos_disponivel)<=0;return e.jsxs("div",{className:"snap-center flex-none flex flex-col bg-white border border-slate-100 rounded-[32px] shadow-lg hover:shadow-2xl transition-all duration-300 w-[210px] overflow-hidden",children:[e.jsxs("div",{className:"w-full bg-center bg-no-repeat aspect-[4/3] bg-cover relative group overflow-hidden",style:{backgroundImage:`url("${t.url_imagem}")`},children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent opacity-60"}),s&&e.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center backdrop-blur-[2px]",children:e.jsx("span",{className:"bg-red-600 text-white px-4 py-1.5 rounded-full text-[9px] font-black uppercase tracking-widest shadow-xl",children:"Esgotado"})}),e.jsx("div",{className:"absolute top-3 left-3 px-2 py-1 rounded-lg bg-black/40 backdrop-blur-md border border-white/10",children:e.jsx("p",{className:"text-[9px] font-black text-primary uppercase",children:"Fundos"})}),e.jsx("div",{className:"absolute bottom-3 right-3 bg-primary text-[#0F1111] px-2.5 py-1.5 rounded-xl shadow-xl border border-white/20 scale-100 group-hover:scale-110 transition-transform",children:e.jsxs("p",{className:"text-[12px] font-black",children:["+",t.taxa_retorno,"%"]})})]}),e.jsxs("div",{className:"p-5 flex flex-col flex-1",children:[e.jsx("h3",{className:"text-slate-900 text-[15px] font-black leading-tight mb-1 line-clamp-1",children:t.nome_fundo}),e.jsx("p",{className:"text-slate-400 text-[9px] font-medium leading-tight mb-3",children:"Aplique e tenha um retorno explosivo ao final do ciclo."}),e.jsxs("div",{className:"flex flex-col gap-4 mt-auto",children:[e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-slate-400 text-[8px] uppercase font-black tracking-widest",children:"Termo"}),e.jsxs("span",{className:"text-slate-900 font-black text-[11px] tabular-nums",children:[t.duration_days," Dias"]})]})}),e.jsx("button",{onClick:()=>{d(t),p(""),m(!1)},disabled:s,className:`flex w-full h-12 items-center justify-center rounded-2xl shadow-xl transition-all font-black text-[10px] uppercase tracking-[0.2em] active:scale-95 ${s?"bg-slate-100 text-slate-300 cursor-not-allowed shadow-none":"bg-primary text-[#0F1111] hover:brightness-105 shadow-primary/20"}`,children:s?"Indisponível":"Aplicar"})]})]})]},t.id_fundo)}):e.jsxs("div",{className:"w-full py-16 flex flex-col items-center justify-center text-slate-300 bg-slate-50/50 rounded-[40px] border-2 border-dashed border-slate-100",children:[e.jsx("span",{className:"material-symbols-outlined text-4xl mb-3 opacity-20",children:"cloud_off"}),e.jsx("p",{className:"font-black text-[9px] uppercase tracking-[0.3em] opacity-40",children:"Sem fundos disponíveis"})]})})}),a&&e.jsx("section",{className:"mt-4 px-6 mb-20 animate-in fade-in slide-in-from-bottom-8 duration-500",children:e.jsxs("div",{className:"bg-white rounded-[48px] border border-slate-100 shadow-2xl p-8 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-10 opacity-[0.03] pointer-events-none",children:e.jsx("span",{className:"material-symbols-outlined text-[180px]",children:"payments"})}),e.jsxs("div",{className:"flex items-center justify-between mb-8 relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"size-14 rounded-2xl bg-[#0F1111] flex items-center justify-center shadow-lg shadow-black/20",children:e.jsx("span",{className:"material-symbols-outlined text-primary text-2xl",children:"account_balance"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-black text-slate-900 leading-tight uppercase tracking-tight",children:a.nome_fundo}),e.jsx("p",{className:"text-slate-400 text-[9px] font-black uppercase tracking-[0.2em] mt-0.5",children:"Configuração de aporte"})]})]}),e.jsx("button",{onClick:()=>d(null),className:"size-10 rounded-full bg-slate-50 flex items-center justify-center text-slate-300 hover:text-red-500 transition-colors",title:"Fechar",children:e.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-8 relative z-10",children:[e.jsxs("div",{className:"bg-slate-50/80 backdrop-blur-sm p-5 rounded-[28px] border border-slate-100 flex flex-col items-center",children:[e.jsx("p",{className:"text-slate-400 text-[8px] font-black uppercase tracking-widest mb-1.5 opacity-60",children:"Taxa de Retorno"}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsxs("span",{className:"text-green-600 text-2xl font-black",children:[a.taxa_retorno,"%"]}),e.jsx("span",{className:"material-symbols-outlined text-green-500 text-sm",children:"trending_up"})]})]}),e.jsxs("div",{className:"bg-slate-50/80 backdrop-blur-sm p-5 rounded-[28px] border border-slate-100 flex flex-col items-center",children:[e.jsx("p",{className:"text-slate-400 text-[8px] font-black uppercase tracking-widest mb-1.5 opacity-60",children:"Termo do Ativo"}),e.jsxs("p",{className:"text-slate-900 text-[14px] font-black tracking-tighter",children:[a.duration_days," DIAS"]})]})]}),e.jsxs("div",{className:"bg-primary/5 rounded-[40px] p-8 border-2 border-dashed border-primary/20 mb-8 relative z-10",children:[e.jsx("label",{className:"text-slate-900 text-[10px] font-black uppercase tracking-[0.3em] mb-5 block text-center opacity-40 italic",children:"Inicie sua aplicação"}),e.jsxs("div",{className:"relative group",children:[e.jsx("span",{className:"absolute left-6 top-1/2 -translate-y-1/2 text-slate-300 font-black text-2xl group-focus-within:text-primary transition-colors",children:"Kz"}),e.jsx("input",{autoFocus:!0,type:"number",min:"100",placeholder:"0.00",className:"w-full h-16 bg-white border-2 border-transparent focus:border-primary rounded-[24px] pl-16 pr-8 text-3xl font-black text-slate-900 outline-none transition-all shadow-xl shadow-black/5",value:l,onChange:t=>p(t.target.value)})]}),e.jsxs("div",{className:"mt-8 p-6 bg-white/60 backdrop-blur rounded-[28px] border border-white shadow-inner flex flex-col items-center",children:[e.jsx("p",{className:"text-slate-400 text-[9px] font-black uppercase tracking-[0.2em] mb-2",children:"Retorno Total Previsto"}),e.jsx("div",{className:"flex items-baseline gap-1",children:e.jsxs("span",{className:"text-green-600 text-3xl font-black tabular-nums tracking-tighter",children:["Kz ",w.toLocaleString("pt-AO")]})})]})]}),e.jsxs("div",{onClick:()=>m(!n),className:`mb-10 p-5 rounded-[28px] border-2 cursor-pointer transition-all duration-500 flex items-center gap-5 ${n?"bg-[#0F1111] border-primary shadow-xl shadow-black/20":"bg-slate-50/50 border-transparent hover:bg-slate-50"}`,children:[e.jsx("div",{className:`size-8 rounded-xl flex items-center justify-center transition-all duration-500 ${n?"bg-primary text-[#0F1111] rotate-[360deg]":"bg-slate-200 text-slate-400"}`,children:e.jsx("span",{className:"material-symbols-outlined text-lg font-black",children:n?"cached":"radio_button_unchecked"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:`text-[10px] font-black uppercase tracking-widest ${n?"text-white":"text-slate-900"}`,children:"Reaplicação Automática"}),e.jsx("p",{className:"text-[9px] mt-1 leading-relaxed text-slate-400",children:"Maximizar lucros com juros compostos ao final do ciclo."})]})]}),e.jsx("button",{onClick:k,disabled:x||!l||Number(l)<=0,className:`w-full h-14 rounded-[24px] font-black text-[11px] uppercase tracking-[0.3em] shadow-2xl transition-all flex items-center justify-center gap-4 ${x||!l||Number(l)<=0?"bg-slate-100 text-slate-300":"bg-[#0F1111] text-white hover:brightness-125 active:scale-95 shadow-black/40"}`,children:x?e.jsx(z,{size:"w-6 h-6",className:"text-primary"}):"Liquidar Fundos"})]})}),!a&&e.jsx("section",{className:"px-4 mt-10 pb-32",children:e.jsxs("div",{className:"p-10 rounded-[44px] bg-primary/5 border-2 border-dashed border-primary/20 flex flex-col items-center justify-center text-center",children:[e.jsx("div",{className:"size-16 rounded-full bg-white flex items-center justify-center shadow-xl mb-5",children:e.jsx("span",{className:"material-symbols-outlined text-primary text-3xl",children:"history"})}),e.jsx("p",{className:"text-black font-black text-[13px] uppercase tracking-[0.1em] mb-2",children:"Minha Carteira"}),e.jsx("p",{className:"text-gray-500 text-[11px] font-medium max-w-[220px] mb-8 leading-relaxed",children:"Gerencie todos os seus contratos ativos e acompanhe os rendimentos em tempo real."}),e.jsx("button",{onClick:()=>i("historico-fundos"),className:"bg-black text-white px-10 h-11 rounded-2xl font-black text-[10px] uppercase tracking-[0.2em] shadow-2xl hover:bg-gray-900 active:scale-95 transition-all",children:"VER MEUS CONTRATOS"})]})})]})};export{S as default};
