import{r as t,j as e,S as v,s as f}from"./index-BauRbZeW.js";const k=({onNavigate:s,showToast:r})=>{const[i,u]=t.useState(!1),[l,p]=t.useState(!1),[d,b]=t.useState(""),[o,g]=t.useState(""),[n,m]=t.useState(!1),h=async a=>{a.preventDefault();const c=d.replace(/\D/g,""),y=o.replace(/\D/g,"");if(c.length!==4){r==null||r("A senha deve conter 4 dígitos numéricos.","warning");return}if(c!==y){r==null||r("As senhas não coincidem.","error");return}m(!0);try{const{data:{user:x}}=await f.auth.getUser();if(!x){r==null||r("Sessão expirada.","error"),s("login");return}const{error:j}=await f.rpc("set_withdrawal_password",{p_password:c});j?r==null||r("Erro ao definir senha.","error"):(r==null||r("Senha de retirada definida com sucesso!","success"),setTimeout(()=>s("profile"),2e3))}catch{r==null||r("Erro inesperado.","error")}finally{m(!1)}};return e.jsxs("div",{className:"relative flex min-h-screen w-full flex-col overflow-x-hidden bg-background-dark font-display text-black antialiased",children:[e.jsxs("header",{className:"sticky top-0 z-10 flex items-center justify-between px-4 py-3 bg-background-dark/95 backdrop-blur-md border-b border-gray-200",children:[e.jsx("button",{onClick:()=>s("profile"),className:"flex size-10 items-center justify-center rounded-full hover:bg-white/10 transition-colors",children:e.jsx("span",{className:"material-symbols-outlined text-primary",style:{fontSize:"24px"},children:"arrow_back"})}),e.jsx("h1",{className:"text-lg font-bold leading-tight tracking-tight flex-1 text-center pr-10",children:"Senha de Retirada"})]}),e.jsxs("main",{className:"flex-1 px-5 py-2 flex flex-col",children:[e.jsxs("div",{className:"mb-6 mt-2",children:[e.jsx("h2",{className:"text-[28px] font-bold leading-tight tracking-tight mb-3",children:"Definir Senha de Retirada"}),e.jsx("p",{className:"text-[text-gray-400] text-base font-normal leading-relaxed",children:"Esta senha será solicitada exclusivamente para confirmar saques, transferências e pagamentos."})]}),e.jsxs("form",{className:"flex flex-col gap-5",onSubmit:h,children:[e.jsxs("div",{className:"space-y-1 pt-2",children:[e.jsx("label",{className:"text-sm font-medium leading-normal text-black ml-1",children:"Nova senha de retirada"}),e.jsxs("div",{className:"relative flex items-center",children:[e.jsx("input",{value:d,onChange:a=>b(a.target.value.replace(/\D/g,"")),maxLength:4,inputMode:"numeric",className:"w-full h-14 rounded-xl border border-[#423f30] bg-surface-dark px-4 pr-12 text-base text-black placeholder-[text-gray-400] focus:border-primary focus:ring-1 focus:ring-primary outline-none transition-all",placeholder:"Crie uma nova senha (4 dígitos)",type:i?"text":"password"}),e.jsx("button",{type:"button",onClick:()=>u(!i),className:"absolute right-0 top-0 h-full w-12 flex items-center justify-center text-[text-gray-400] hover:text-primary transition-colors",children:e.jsx("span",{className:"material-symbols-outlined",style:{fontSize:"24px"},children:i?"visibility":"visibility_off"})})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium leading-normal text-black ml-1",children:"Confirmar nova senha de retirada"}),e.jsxs("div",{className:"relative flex items-center",children:[e.jsx("input",{value:o,onChange:a=>g(a.target.value.replace(/\D/g,"")),maxLength:4,inputMode:"numeric",className:"w-full h-14 rounded-xl border border-[#423f30] bg-surface-dark px-4 pr-12 text-base text-black placeholder-[text-gray-400] focus:border-primary focus:ring-1 focus:ring-primary outline-none transition-all",placeholder:"Repita a nova senha",type:l?"text":"password"}),e.jsx("button",{type:"button",onClick:()=>p(!l),className:"absolute right-0 top-0 h-full w-12 flex items-center justify-center text-[text-gray-400] hover:text-primary transition-colors",children:e.jsx("span",{className:"material-symbols-outlined",style:{fontSize:"24px"},children:l?"visibility":"visibility_off"})})]})]}),e.jsx("div",{className:"flex-1 min-h-[40px]"}),e.jsx("button",{type:"submit",disabled:n,className:`w-full h-14 rounded-full bg-primary hover:bg-primary/90 active:scale-[0.98] transition-all flex items-center justify-center shadow-lg shadow-primary/20 mb-6 ${n?"opacity-50":""}`,children:n?e.jsx(v,{size:"w-6 h-6",className:"text-black"}):e.jsx("span",{className:"text-[#181711] text-base font-bold tracking-wide",children:"Confirmar"})})]})]})]})};export{k as default};
